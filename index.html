<!DOCTYPE html>
<html lang="en">

<head>
  <link href="https://fonts.googleapis.com/css2?family=EB+Garamond:wght@400;600&family=Inter:wght@300;400&display=swap" rel="stylesheet">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/png" href="Other/RadioactiveSign.png">
  <title>Radiopharmaceuticals </title>

  <!-- CSS -->
  <link rel="stylesheet" href="HTML/style.css">
  <style>
    /* Hide the entire SPARQL editor UI – keeps functionality but removes it visually */
    #sparqlEditor { display: none !important; }
  </style>
  <!-- D3 -->
  <script src="https://d3js.org/d3.v7.min.js"></script>
</head>

<body>
  <div class="layout">
    
    <!-- LEFT SIDEBAR -->
    <nav class="sidebar">
      <ul>
        <li><a href="HTML/introPage.html">Home</a></li>
        <li><a href="HTML/about.html">Author</a></li>
        <li><a href="HTML/Dishes.html">Dishes</a></li>
        <li><a href="HTML/sparql.html">Sparkling Wine Explorer™</a></li>
      </ul>
    </nav>

    <div class="content-wrapper">
      <h1>RADIOPHARMACEUTICALS</h1>
      <h2 style="text-align:center;">Exploring protein targets visually</h2>

      <h2>What are radiopharmaceuticals?</h2>
      <hr>
      <i> You can find an inspiration for our project
        <a href="https://reasonator.toolforge.org/?q=Q33202843&lang=en" target="_blank" style="color:white;">
          here.
        </a>

      </i>
      <br><br>

      <p>
        <img src="https://pubs.acs.org/cms/10.1021/acscentsci.3c01050/asset/images/large/oc3c01050_0001.jpeg"
          alt="Radiopharmaceuticals diagram" height="200">
          <img src="Other/pet2.gif" height="200">
          
        Radiopharmaceuticals, or medicinal radiocompounds, are a group of pharmaceutical drugs containing radioactive
        isotopes...
        
        <br><br><br><br>
      </p>

      <hr>
      <div class="box">
        <h3>Research question:</h3>
        <p> Which receptors are most commonly targeted by radiopharmaceuticals, and how do their binding
        selectivity profiles vary?</p>
        
      </div>

      <h2>Method</h2>
      <hr>
      <div class="box">
        <h3>How were radiopharmaceuticals identified? </h3>
        <p> Radiopharmaceuticals were found from the ChEMBL endpoint using their <strong>Anatomical Therapeutic Chemical (ATC) </strong> classification codes. Compounds with ATC codes beginning with <strong>V09</strong> (Diagnostic radiopharmaceuticals) or <strong>V10</strong> (Therapeutic radiopharmaceuticals) were selected for this project. </p>
        </div>
        <p>When looking for radiopharmaceuticals linked to their relevant receptors, only three molecules had data. The absence of data is likely due to the difficulty of obtaining this biological information, as assays for radioactive molecules are expensive and complex. However, attaching a radioactive atom usually does not change the binding pharmacology or affinity of the compound to its receptor. Thus, the radiopharmaceutical's binding affinity and selectivity to receptors can be equivalent to its <strong>"parent"</strong> molecule, or the non-radioactive version. Thus, all downstream analyses were based on the parent molecule’s binding data. </p>
        
        <h3>How were primary targets for parent molecules determined? </h3>
<p>
  <em>K<sub>i</sub></em> is the inhibition constant, which defines how tightly a molecule binds to a protein. 
  A low <em>K<sub>i</sub></em> means strong binding, while a high <em>K<sub>i</sub></em> indicates weak binding. 
  <em>K<sub>i</sub></em> values are commonly used in drug discovery to quantify ligand–protein interactions 
  and discover which proteins the parent molecule prefers.
</p>

<p>
  Primary targets were defined as the proteins with the lowest <em>K<sub>i</sub></em> (best binding).<br>
  Secondary, or off-targets, were defined as proteins with higher <em>K<sub>i</sub></em>.
</p>

<h3>How was target selectivity quantified?</h3>

<p>
  Selectivity quantifies how much better a molecule binds to its primary target compared to its other targets. 
  The selectivity ratio was determined by dividing the <em>K<sub>i</sub></em> of the target by the minimum 
  <em>K<sub>i</sub></em> value:
</p>

<p>
  <strong>Selectivity ratio</strong> = <em>K<sub>i,target</sub></em> / <em>K<sub>i,min</sub></em>
</p>
<div style="color: white;">
<table border="1" cellspacing="0" cellpadding="6">
  <thead>
    <tr>
      <th>Selectivity ratio</th>
      <th>Interpretation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1.0</td>
      <td>Primary target, strongest binder</td>
    </tr>
    <tr>
      <td>&gt; 1</td>
      <td>Off-target, weaker binding</td>
    </tr>
    <tr>
      <td>Large ratio</td>
      <td>Highly selective binding; large preference for main target</td>
    </tr>
    <tr>
      <td>Small ratio</td>
      <td>Weak selectivity; the molecule binds to proteins almost equally well</td>
    </tr>
  </tbody>
</table>

      </div>
  <h2>Results</h2>
<p>
  The knowledge graph was used to visualize relationships between radiopharmaceuticals (yellow nodes), 
  their parent molecules (blue nodes), and the protein targets (pink nodes) they bind to. 
  The edges represent binding relationships where each parent molecule is connected to its protein targets, 
  and each radiopharmaceutical is linked to its non-radioactive parent molecule.
</p>

<p>Some protein targets appear multiple times, connected to different parent molecules:</p>
<ul>
  <li>Carbonic anhydrase isoforms (I, II, IV, IX) linked to sodium iodide and sodium fluoride</li>
  <li>Carbonic anhydrase II links sodium iodide and sodium phosphate</li>
  <li>Beta amyloid A4 protein targeted by flutemetamol and florbetapir</li>
</ul>

<p>Others are specific to a type of protein:</p>
<ul>
  <li>Monoamine transporters (dopamine, serotonin, norepinephrine) linked to iodine 2β-carbomethoxy-3β-(4-iodophenyl)-tropane</li>
  <li>Dopamine receptors (D1, D2, D3, D4) only targeted by iolopride</li>
</ul>

<p>
  Thus, the knowledge graph shows that radiopharmaceuticals target a limited category of proteins, 
  illustrating their selectivity for specific biological functions.
</p>

<p>
  To visualize the target selectivity for parent molecules, we plotted log-transformed affinity values (log(1/Ki)) to emphasize the primary target, which appears as the tallest bar in the chart, and the off-targets in decreasing order. 
</p>

      
      <hr style="height:5px; background-color: white;">
        
      <script>
        console.log("D3 version:", d3.version);
      </script>

      <div class="section">


        <label for="endpoint">Endpoint URL:</label><br>
        <input id="endpoint" type="text" value="https://chemblmirror.rdf.bigcat-bioinformatics.org/sparql"><br><br>

        <!-- SPARQL QUERY -->
        <label for="query">SPARQL Query:</label><br>
        <textarea id="query" rows="8" style="width:100%;">
PREFIX cco:   <http://rdf.ebi.ac.uk/terms/chembl#>
PREFIX rdfs:  <http://www.w3.org/2000/01/rdf-schema#>
PREFIX xsd:   <http://www.w3.org/2001/XMLSchema#>

SELECT DISTINCT
  ?molecule           # radiopharmaceutical child
  ?molName
  ?atcCode
  ?molecule2          # parent molecule (the one with binding data)
  ?mol2Name
  ?target
  ?targetName
  ?Ki                 # best Ki (nM) for this target & molecule2
  ?KiBest             # best Ki over all targets for this molecule2
  (xsd:decimal(?Ki) / xsd:decimal(?KiBest) AS ?Selectivity_vs_best)
WHERE {

  ######## Radiopharmaceutical and parent molecule ########

  ?molecule a cco:SmallMolecule ;
            rdfs:label ?molName ;
            cco:atcClassification ?atcCode ;
            cco:hasParentMolecule ?molecule2 .

  FILTER(STRSTARTS(STR(?atcCode), "V09") || STRSTARTS(STR(?atcCode), "V10"))

  ?molecule2 rdfs:label ?mol2Name .

  ######## Per-target Ki for each parent molecule (molecule2) ########

  {
    SELECT ?molecule2 ?target ?targetName (MIN(xsd:decimal(?value)) AS ?Ki)
    WHERE {
      ?activity  cco:hasMolecule ?molecule2 ;
                 cco:hasAssay    ?assay ;
                 cco:type        ?type ;
                 cco:standardValue ?value .

      ?assay cco:hasTarget ?target .
      ?target rdfs:label ?targetName .

      FILTER(?type = "Ki")
    }
    GROUP BY ?molecule2 ?target ?targetName
  }

  ######## Best Ki per molecule2 ########

  {
    SELECT ?molecule2 (MIN(xsd:decimal(?valueBest)) AS ?KiBest)
    WHERE {
      ?activityBest  cco:hasMolecule ?molecule2 ;
                     cco:hasAssay    ?assayBest ;
                     cco:type        ?typeBest ;
                     cco:standardValue ?valueBest .
      FILTER(?typeBest = "Ki")
    }
    GROUP BY ?molecule2
  }
}
ORDER BY ?molecule2 ?Selectivity_vs_best
LIMIT 500
      </textarea><br>

        <button id="run" style="background-color:#04AA6D; color:white; padding:5px 10px; border:none; cursor:pointer;">
          Run Query 
        </button>

        <!-- VIEW SELECTOR -->
        <br><br>
        <label style="color:white;">View:</label>
        <select id="viewSelector" style="margin-left:10px; padding:5px;">
          <option value="table">Table (Query Results)</option>
          <option value="graph">Knowledge Graph</option>
          <option value="chart">Selectivity Chart</option>
        </select>

        <!-- TABLE RESULTS -->
        <div id="tableContainer" style="margin-top:20px; color:white;">
          <div id="results"></div>
        </div>
    
        <!-- GRAPH RESULTS -->
        <div id="graphContainer" style="display:none; margin-top:20px;">
          <h2 style="color:white;">Knowledge graph</h2>
          <svg id="graph" width="850" height="800" style="background:#102030;"></svg>
        </div>

        <!-- CHART RESULTS -->
        <div id="chartContainer" style="display:none; margin-top:20px;">
          <h2 style="color:white;">Selectivity vs best Ki</h2>
          <label style="color:white;">Parent molecule:</label>
          <select id="moleculeSelector" style="margin-left:10px; padding:5px;"></select>

          <span style="margin-left: 20px; color: white;">Scale:</span>
          <button id="btnLinear"
            style="margin-left:5px; padding:5px; cursor:pointer; background-color:#66ccff; border:none;">Linear</button>
          <button id="btnLog"
            style="margin-left:5px; padding:5px; cursor:pointer; background-color:#ddd; border:none;">Logarithmic</button>

          <svg id="chart" width="1000" height="400" style="background:#102030; margin-top:10px;"></svg>
        </div>


         <script src="graphing.js" ></script>  <!-- visualisation all here in js file. -->

</body>
</html>
